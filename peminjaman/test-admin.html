<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Admin Panel</title>
  <style>
    body { font-family: system-ui; padding: 20px; max-width: 800px; margin: 0 auto; }
    .test { padding: 10px; margin: 10px 0; border-radius: 8px; }
    .pass { background: #d4edda; border: 1px solid #c3e6cb; }
    .fail { background: #f8d7da; border: 1px solid #f5c6cb; }
    button { padding: 8px 16px; margin: 5px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>ðŸ§ª Test Admin Panel Components</h1>
  
  <div id="results"></div>
  
  <h3>Actions:</h3>
  <button onclick="runTests()">Run All Tests</button>
  <button onclick="location.href='admin.html'">Open Admin Panel</button>
  <button onclick="location.href='index.html'">Back to Home</button>

  <script src="assets/js/app.js"></script>
  <script>
    function addResult(name, pass, msg) {
      const div = document.createElement('div');
      div.className = 'test ' + (pass ? 'pass' : 'fail');
      div.innerHTML = `<strong>${pass ? 'âœ“' : 'âœ—'} ${name}</strong><br>${msg}`;
      document.getElementById('results').appendChild(div);
    }

    function runTests() {
      document.getElementById('results').innerHTML = '';
      
      // Test 1: SPFK object exists
      addResult('SPFK Global Object', typeof SPFK !== 'undefined', 
        typeof SPFK !== 'undefined' ? 'SPFK loaded successfully' : 'SPFK not found');
      
      // Test 2: Check Loans functions
      addResult('SPFK.getLoans', typeof SPFK?.getLoans === 'function',
        typeof SPFK?.getLoans === 'function' ? 'getLoans function available' : 'getLoans missing');
      
      // Test 3: Check localStorage
      try {
        const loans = SPFK.getLoans();
        addResult('Load Loans from localStorage', true, 
          `Found ${loans.length} loan(s) in storage`);
      } catch(e) {
        addResult('Load Loans from localStorage', false, e.message);
      }
      
      // Test 4: Check Facilities
      try {
        const facs = SPFK.getFacilities();
        addResult('Load Facilities from localStorage', true, 
          `Found ${facs.length} facility(s) in storage`);
      } catch(e) {
        addResult('Load Facilities from localStorage', false, e.message);
      }
      
      // Test 5: Vue loaded
      addResult('Vue 3 CDN', typeof Vue !== 'undefined',
        typeof Vue !== 'undefined' ? 'Vue 3 is loaded' : 'Vue 3 not loaded - check CDN');
      
      // Test 6: Check API availability
      fetch('http://localhost:4000/api/health')
        .then(res => res.json())
        .then(data => {
          addResult('Backend API Connection', true, 'API is running at http://localhost:4000');
        })
        .catch(err => {
          addResult('Backend API Connection', false, 
            'API not running. Admin Panel will use localStorage mode.');
        });
    }
    
    // Auto-run on load
    window.addEventListener('DOMContentLoaded', runTests);
  </script>
</body>
</html>
